<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
        body, html{
            width: 100%;
            height: 100%;
            margin:0;
        }
        #allmap {
            height:500px; width: 100%;
        }
        .button {
            width: 60px;
            height: 60px;
            border: 1px solid #006633;
            background-color: #00CCFF;
        }
    </style>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=lQdsfRa5RghKht0IbnYQ4Mom"></script>
    <title>电子围栏</title>
</head>
<body>
    <div id="allmap"></div>
    <div>
        <div class="button" id="done">ok</div>
    </div>
    <script type="text/javascript">
        // 百度地图API功能
        var map = new BMap.Map("allmap");
        map.centerAndZoom(new BMap.Point(116.404, 39.915), 15);
        map.enableScrollWheelZoom();

        /*var polygon = new BMap.Polygon([
            new BMap.Point(116.387112,39.920977),
            new BMap.Point(116.385243,39.913063),
            new BMap.Point(116.394226,39.917988),
            new BMap.Point(116.401772,39.921364),
            new BMap.Point(116.41248,39.927893)
        ], {
            strokeColor:"blue",
            strokeWeight:2,
            strokeOpacity:0.5
        });  //创建多边形
        map.addOverlay(polygon);   //增加多边形

        polygon.enableEditing();*/

        var polygon = new BMap.Polygon();
        var points = [];

        map.addEventListener("click", function(e) {
            var m1 = new BMap.Marker(new BMap.Point(e.point.lng, e.point.lat));
            map.addOverlay(m1);

            points.push(new BMap.Point(e.point.lng, e.point.lat));

        });

        var done = document.getElementById("done");
        done.addEventListener("click", function(e) {
            polygon.setPath(points);
            map.addOverlay(polygon);
        });
    </script>
</body>
</html>

